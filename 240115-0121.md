# 经典控制算法（一）PID简介以及位置PID算法实现

## 线性系统的时域分析

线性系统的时域分析建立于该系统稳定的前提之上（衡量系统的主要指标为稳、快、准），对于系统的动态性能通常如下：

| 指标          | 指标内容                                                     |
| ------------- | ------------------------------------------------------------ |
| 上升时间$t_r$ | 指相应从终值10%上升到90%所需的时间；<br />对于有震荡的系统，亦可定义为响应从零第一次上升到终值所需的时间。<br />上升时间是系统相应速度的一种度量，上升时间越短，相应速度越快。 |
| 峰值时间$t_p$ | 指相应超过其终值到达第一个峰值所需的时间                     |
| 调节时间$t_s$ | 指响应到达并保持在终值±5%内所需的最短时间。                  |
| 超调量σ\%     | 指响应的最大偏离量$c(t_p)$与终值$c(∞)$的差与终值$c(∞)$之比的百分数即：<br /> $$σ\%=\frac{c(t_p)-c(∞)}{c(∞)}*100\%$$<br />若$c(t_p)<c(∞)$则响应无超调（即超调量为0？） |

通常上述四个动态指标中，$t_r$和$t_p$评价系统的响应速度，用σ\%评价系统的阻尼程度，而$t_s$是同时反应响应速度的综合性能指标。

## PID简介

PID即proportional（比例），integral（积分），differential（微分）。PID控制算法是一种将反馈环节获取的信号转换成控制环节的信号的一种算法。此算法可以使系统处于一种趋于稳定的状态。

连续PID时域式为：
$$
u(t)=K_p(e(t)+\frac{1}{T_t}\int_0^te(t)dt+T_d\frac{de(t)}{dt})
$$

$K_p$为比例增益，$T_t$为积分时间常数，$T_d$为微分时间常数，u（t）控制信号，e（t）反馈信号与终值的误差。

## 比例环节（Proportional）

纯比例控制为最简单的一种控制方式，比例系数与系统的响应速度成正比，与阻尼程度成反比。即随着$K_p$增大系统的$t_r$和$t_p$减小，σ\%增大。

## 积分环节（Integral）

在比例环节产生了稳态误差，在积分环节中就是消除稳态误差。

## 微分环节（Differential）



## 位置式PID算法实现

```c
typedef struct {
    float target_val;     //目标值
	float actual_val;     //实际值
	float err;            //定义当前偏差值
	float err_last;       //定义上一个偏差值
	float Kp, Ki, Kd;     //定义比例、积分、微分系数
	float integral;       //定义积分值
} PID_Typedef;

float PID_Process(PID_Typedef *pid_obj,float current_val){
    pid_obj->actual_val=current_val;
    pid_obj->err=pid_obj->target_val-pid_obj->actual_val;
    pid_obj->integral+=pid_obj->err;

    pid_obj->actual_val = pid_obj->Kp*pid_obj->err
                        + pid_obj->Ki*pid_obj->integral
                        + pid_obj->Kd*(pid_obj->err-pid_obj->err_last);
    
    pid_obj->err_last=pid_obj->err;
    
    return pid_obj->actual_val;
}
```

