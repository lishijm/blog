# 经典控制算法（二）离散时间PID控制器&PID算法实现

## PID控制器离散化

因为计算机处理为数字处理，反馈环节采样和作用环节处理并未理想连续而是离散的。所以需要对与连续时间的PID控制器模型进行离散化处理：

$$
u(t)=K_pe(t)+K_i\int_0^te(τ)dt+K_d\frac{de(t)}{dt}
$$

离散化：

$$
u(n)=K_pe(n)+K_i\sum_{i=0}^{n}e(n)+K_d(e(n)-e(n-1))
$$

n:采样次数

## 位置式PID算法实现

PID控制器离散化直接算法实现即为位置式PID。该算法针对的是控制结果不会产生累加影响的应用场景下。

```c
typedef struct {
    float target_val;     //目标值
	float actual_val;     //实际值
	float err;            //定义当前偏差值
	float err_last;       //定义上一个偏差值
	float Kp, Ki, Kd;     //定义比例、积分、微分系数
	float integral;       //定义积分值
} PID_Typedef;

float PID_Process(PID_Typedef *pid_obj,float current_val){
    pid_obj->actual_val=current_val;
    pid_obj->err=pid_obj->target_val-pid_obj->actual_val;
    pid_obj->integral+=pid_obj->err;

    pid_obj->actual_val = pid_obj->Kp*pid_obj->err
                        + pid_obj->Ki*pid_obj->integral
                        + pid_obj->Kd*(pid_obj->err-pid_obj->err_last);
    
    pid_obj->err_last=pid_obj->err;
    
    return pid_obj->actual_val;
}
```

## 增量式PID算法实现

增量式
